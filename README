fdm is a small program designed to fetch mail from POP3 servers, or receive
local mail from stdin, and deliver it in various ways.

There are two main ways of using fdm, single-user and multiuser:

--------------------------------------------------------------------------------
SINGLE-USER
--------------------------------------------------------------------------------
When fdm is run as a non-root user, it will not attempt to drop privileges and
all mail will be delivered as the user it is run as - the "user" keyword on
rules and actions will be ignored. It is best run from cron every so often, for
example:

*/30    *       *       *       *       /usr/local/bin/fdm -l -x stdin fetch

Local mail can be delivered via stdin. See the fdm(1) man page for an example
using sendmail, users of other MTAs are on their own for the moment. Man page 
diffs and/or instructions I can format into the man page would be appreciated.

The included fdm.conf is an example of a single-user configuration.

--------------------------------------------------------------------------------
MULTIUSER
--------------------------------------------------------------------------------
When fdm is run as a root user, it will drop to user _fdm and chroot to that
user's home directory in order to fetch mail. You can add the user, on OpenBSD,
with:

	# useradd -u 999 -s /bin/nologin -d /var/empty -g=uid _fdm

Mail will be delivered either using the user specified in the rule or action or
the user specified by the "defuser" keyword (or with the -u switch on the
command line). A config file for multiuser may look something like:

	set defuser "bob"
	account ......
	action "default" maildir "%h/mail/inbox"
	# continue is used for these two so that Cc or To headers lines with
	# multiple users work (otherwise they would be delivered to the first)
	match "^(To:|Cc:).*[ \t]jim@my.domain" user "jim" action "default" continue
	match "^(To:|Cc:).*[ \t]sam@my.domain" user "sam" action "default" continue
	# no continue here, otherwise all mail would end up at the last rule,
	# not just unmatched
	match "^(To:|Cc:).*[ \t]bob@my.domain" user "bob" action "default"
	match all action "default" # the rest will use the default user

Alternatively, it could be something like this:

	set defuser "bob" # this is required but not used in this file
	account ......
	action "jim" user "jim" mbox "/var/mail/jim"
	action "sam" user "sam" mbox "/var/mail/sam"
	action "bob" user "bob" mbox "/var/mail/bob"
	match "^(To:|Cc:).*[ \t]jim@my.domain" action "jim" continue
	match "^(To:|Cc:).*[ \t]sam@my.domain" action "sam" continue
	match "^(To:|Cc:).*[ \t]bob@my.domain" action "bob"
	match all action "bob" # all other mail will end up with bob

If you use POP3 accounts fdm is best run from cron, but it can also be set up
to deliver mail via stdin from an MTA. Configuring this is left as an exercise
for the reader. If you're using some MTA than can invoke fdm with the -u
option, you'd probably just need something like:

	account stdin "stdin"
	action "default" mbox "/var/mail/%u"
	match all action "default"

Since fdm will use then deliver using the default user from stdin.

Look at the fdm(1) and fdm.conf(5) man pages for details of syntax, etc.

--------------------------------------------------------------------------------
This is beta-quality software. There will be bugs. I use maildirs so they are
the most tested.

Feedback, bug reports, suggestions, etc, are welcome.

I usually prefer to use the address below but with their customary efficiency
SF.net seem to be only permitting some mail to actually get through (or they
changed something and didn't tell us), so I can also be reached at:
nicm123@gmail.com

Nicholas Marriott
nicm@users.sourceforge.net

# $Id$
